---
title: "Final_Project_GRShipping"
author: "Alex Billinis"
format: html
editor: visual
---

## Quarto

Quarto enables you to weave together content and executable code into a finished document. To learn more about Quarto see <https://quarto.org>.

## 

First of all, let's bring in the data, and, crucially, lets also separate dates by day, month, year.

```{r}
library(ggplot2)
library(ggmap)
library(tidyverse)
Grships <- read.csv("Greek_Ships_Sunk_MasterfileEXCEL.csv", header = TRUE)
#We need to split dates to day-month-year
Tidy_Ships <- separate(Grships, col = Date, into = c("Day", "Month", "Year"), sep = "-", remove = FALSE)
#Tidy_Ships <- Tidy_Ships %>% mutate(Month = recode(Month,
           #             Jan = 1,
            #            Feb = 2,
            #            Mar = 3,
               #         Apr = 4,
              #          May = 5,
              #          Jun = 6,
              #          Jul = 7,
               #         Aug = 8,
                  #      Sep = 9,
                    #    Oct = 10,
                     #   Nov = 11,
                      #  Dec = 12))

```

Now, let's check data based on Greece's entry into World War Two. First, 28 October 1940, the day that Greece was attacked by Italy and entered World War Two, and, second, 6 April 1941, the day that Germany attacked Greece. The question is, how many Greek ships were sunk when Greece was not involved in the war at all?

```{r}
#Pre_Oct <- Tidy_Ships %>% filter(Year <= 40) %>% filter(Month <= 10) %>% filter(Day <= 28)
```

```{r}
Pre_Oct <- Tidy_Ships %>% filter(Year <= 40) %>% filter(Month <= 10) %>% filter(Day <= 28)
```

```{r}
Pre_April <- Grships %>% filter(Date <= "6-Apr-41")
```

```{r}
library(ggplot2)
Grcategory <- Pre_Oct %>% group_by(Ship_Name) %>% summarize(count = n()) 
ggplot(Grcategory, aes(x = Ship_Name, y = count)) + geom_col()

```

It is worth contrasting the Greek Ships' losses while neutral with the American. From September 3 1939 to December 6, 1941, there are only

```{r}
Amships <- read.csv("USShips_Pre12_7.csv")
Amcategory <- Amships %>% group_by(Flag) %>% summarize(count = n()) 
ggplot(Amcategory, aes(x = Flag, y = count)) + geom_col()
```

The `echo: false` option disables the printing of code (only output is displayed).

```         
```

```{r}
#install.packages("ggmap")
library(dplyr)
library(tidyverse)
library(lubridate)
library(ggplot2)
library(basemaps)

AerialAtl <- Grships %>% 
  filter(Event == "Aerial Bombing" & Location == "Atlantic")
head(AerialAtl)
```

```{r}
mapinfo <- map_data(world)
```

```{r}
library(ggplot2)
library(maps)
library(tidyverse)
library(sf) 
library(rnaturalearth)
mapdata <- map_data("world")
view(mapdata)
```

```{r}
mapdata <- left_join(mapdata, AerialAtl, by="region")
```

```{r}
world <- ne_countries(scale = "medium", returnclass = "sf")
Europe <- world[which(world$continent == "Europe"),]
map <- ggplot(Europe) +
  geom_sf() +
  coord_sf(xlim = c(-25,50), ylim = c(35,70), expand = FALSE)
map + geom_point(data=AerialAtl, mapping=aes(x=Long, y=Lat, group=NULL), color='blue')
```

```{r}
Atlmap <- map_data("ocean", ocean = "Atlantic")
```

```{r}
Atldata <- AerialAtl %>%
  filter(ocean == "Atlantic")
ggplot() +
  geom_polygon(data = Altmap, aes(x = long, y = lat, group = group), fill = "purple", color = "white") +
  geom_point(data = Atldata, aes(x = lon, y = lat), color = "lime green", size = 0.25) +
  ggtitle("Aerial Bombardment Atlantic") +
  theme_minimal()
```

```{r}
ggplot(AerialAtl,aes(x = Longitud, y = Latitude)) + 
  geom_map(data = Atlantic, map = Atlantic, aes(long, lat, map_id=region)) +
  geom_point(data = AerialAtl, mapping = aes(x=lon, y=lat))
```

```{r}
AerialMed <- Grships %>% 
  filter(Event == "Aerial Bombing" & Location == "Mediterranean")
```

```{r}
ggplot(data = world) +
    geom_sf() +
    xlab("Longitude") + ylab("Latitude") +
    ggtitle("World map", subtitle = paste0("(", length(unique(world$NAME)), " countries)"))
```
